dom:
  div:
    ui.loading:
      v-if: is.loading
    ui.select:
      ":options": entities
      :get-item-icon: () => '📁'
      :get-item-text: (entity) => entity.name
      :get-item-number: (entity) => entity.count
      input-type: value
      v-model: selectedEntity

props:
  dbp: null

data:
  entities: null
  selectedEntity: null
  is:
    loading: 0

methods:
  selectEntity: | #js
    function(entity) {
      this.selectedEntity = entity;
    }
  refresh: | #js
    async function() {
      this.is.loading++;
      this.entities = (await this.dbp.get.entity.infos());
      this.is.loading--;
    }

watch:
  dbp:
    handler: | #js
      async function(dbp) {
        this.refresh();
      }
    immediate: true
  selectedEntity: | #js
    function(selectedEntity) {
      this.$emit("input", selectedEntity);
    }
