dom:
  div:
    ui.html.style:
      :css-style-obj: gridCssStyleObj
    div:
      v-if: (!showExample)
      :class: "'grid-' + gridID"
      slot:
    div:
      v-else-if: (showExample && grid)
      .grid-name:
        v-if: showGridName
        v-text: grid.name
      div:
        div:
          class: grid-opacity-overlay
        div:
          :class: "'grid-' + gridID"
          .box:
            v-for: (area, index) in getGridBoxes(grid)
            :key: "'box-' + index"
            :data-area: "{ area }"

props:
  grid:
  showExample: false
  showGridName: true

methods:
  getGridBoxes: | #js
    function(grid) {
      if (!grid) return null;
      const { areas } = grid.template;
      const namedAreas = grid.template.named?.areas;
      if (namedAreas) return namedAreas?.flat();
      if (grid.example?.boxes) return Array.from({ length: (grid.example.boxes ?? 1) })
        .map((b, i) => `box-${i}`);
      return [];
    }

computed:
  gridCssStyleObj: | #js
    function() {
      if (!this.grid) return null;
      const s = {};
      const { columns, rows, areas } = this.grid.template;
      const namedAreas = this.grid.template.named?.areas;

      s[`.grid-${this.gridID}`] = {
        'display': 'grid',
        'gap': '0.2em',
        'aspect-ratio': ((!this.showExample) ? null : this.grid.example?.aspect?.ratio),
        'grid-template-columns': columns,
        'grid-template-rows': rows,
        'grid-template-areas': namedAreas?.map(row => `"${row.join('" "')}"`).join(' '),
      };

      if (areas) {
        for (let i = 0; i < areas.length; i++) {
          const area = areas[i];
          s[`.grid-${this.gridID} > :nth-child(${(i + 1)})`] = {
            'grid-area': area.join(' / ')
          };
        }
      }

      Objects.removeNullValueKeys(s);
      return s;
    }
  gridID: | #js
    function() {
      return this._uid;
    }

style:
  .grid:
    display: grid
    gap: 0.5em
  .grid-name:
    opacity: 0.5
    text-align: center
  .grid-opacity-overlay:
    position: absolute
    bottom: 0
    left: 0
    width: 100%
    height: 100%
    border-radius: 0
    background: linear-gradient(to bottom, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 1) 100%)
    z-index: 10
    pointer-events: none
  .box:
    display: flex
    justify-content: center
    align-items: center
    min-width: 1em
    min-height: 1em
    background: gray
    border-radius: 0.2em
