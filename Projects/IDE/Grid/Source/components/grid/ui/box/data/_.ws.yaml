dom:
  grid.module:
    icon: ðŸ§Š
    ':show-title': 'false'
    div: 
      ':style': '{ ''width'': ''100%'', overflow: ''auto'' }'
      div: 
        v-if: 'false'
        ui.expand:
          icon: ðŸ“‹
          text: fields
          ':number': selectedFields.length
          v-model: showFieldsFilter
        transition:
          name: slide2
          div: 
            v-if: showFieldsFilter
            ui.checkbox:
              v-for: field in fields
              ':text': field
              ':value-array': selectedFields
              ':value-key': field
      ui.value:
        ':value': boxValue
props:
  box: null
data:
  selectedFields: []
  showFieldsFilter: false
methods:
  getBoxVue: | #js
    function() {
      return this.$root.vm.getAncestors(this, "grid.ui.box")[0];
    }
  init: | #js
    function(box) {
      this.selectedFields = (box.selected?.fields || []);
    }
computed:
  boxValue: | #js
    function() {
      const socketData = this.$root.socket?.runtime.data[this.box._id];
      return socketData?.input?.[1] || this.box.value;
    }
  fields: | #js
    function() {
      if (!Array.isArray(this.boxValue)) return [];
      if (!this.boxValue.length) return [];
      const firstItem = this.boxValue[0];
      if (typeof firstItem !== "object") return [];
      return Object.keys(firstItem);
    }
watch:
  box:
    handler: | #js
      async function(box) {
        this.init(box);
      }
    immediate: true
  selectedFields: | #js
    function(selectedFields) {
      //this.getBoxVue().$femit("edit.box", this.box._id, { selected: { fields: selectedFields } });
    }
_:
  examples:
    count: 0
name: grid-ui-box-data
template: >-
  <grid-module class="comp-grid-ui-box-data" icon="ðŸ§Š" :show-title="false"
  path="1558979935."><div :style="{ 'width': '100%', overflow: 'auto' }"
  path="1558979935.0"><div v-if="false" path="1558979935.0.0"><ui-expand
  icon="ðŸ“‹" text="fields" :number="selectedFields.length"
  v-model="showFieldsFilter" path="1558979935.0.0.0"></ui-expand><transition
  name="slide2" path="1558979935.0.0.1"><div v-if="showFieldsFilter"
  path="1558979935.0.0.1.0"><ui-checkbox v-for="field in fields" :text="field"
  :value-array="selectedFields" :value-key="field"
  path="1558979935.0.0.1.0.0"></ui-checkbox></div></transition></div><ui-value
  :value="boxValue" path="1558979935.0.1"></ui-value></div></grid-module>
