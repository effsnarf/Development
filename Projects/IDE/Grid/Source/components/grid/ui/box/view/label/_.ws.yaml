dom:
  grid.module:
    icon: 🆎
    ':show-title': 'false'
    h2:
      @click: refresh
      v-text: text
props:
  box: null
  dataBoundSocketData: null
data:
  field: null
  activeSocketData: null
  boxValue: null
  text: null
mounted: | #js
  async function() {
    await this.$nextTick();
    this.refresh();
  }
methods:
  grid_client_runtime_socket_value_change: | #js
    function(boxID, sDirection, sID, sValue) {
      if (boxID != this.box._id) return;
      this.refresh();
    }
  getBoxVue: | #js
    function() {
      return this.$root.vm.getAncestors(this, "grid.ui.box")[0];
    }
  getActiveSocketData: | #js
    function() {
      let boxData = (this.$root.socket?.runtime.data[this.box._id] || {});
      boxData = Objects.deepMerge(boxData, (this.dataBoundSocketData || {}));
      return boxData;
    }
  getText: | #js
    function(boxValue) {
      if (!boxValue) return "[❔ text]";
      if (typeof boxValue == "object") return (boxValue.sub || boxValue.title || boxValue.com);
      return boxValue;
    }
  refresh: | #js
    function() {
      this.activeSocketData = this.getActiveSocketData();
      this.boxValue = this.activeSocketData?.input?.[1];
      this.text = this.getText(this.boxValue);
    }
computed:
  fieldFunc: | #js
    function() {
      if (typeof this.field == "string") return (item) => item[this.field];
      if (typeof this.field == "function") return this.field;
      return ((item) => item);
    }
watch:
  box:
    handler: | #js
      async function(box) {
        this.field = box?.field;
      }
    immediate: true
  field:
    handler: | #js
      async function(field) {
        if (field == this.box.field) return;
        await this.$nextTick();
        this.getBoxVue().$femit("edit.box", this.box._id, { field });
      }
    immediate: false
_:
  examples:
    count: 0
name: grid-ui-box-view-label
template: >-
  <grid-module class="comp-grid-ui-box-view-label" icon="🆎" :show-title="false"
  path="2104471648."><h2 @click="refresh" v-text="text"
  path="2104471648.0"></h2></grid-module>
