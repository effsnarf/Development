dom:
  div:
    component:
      ':is': getBoxCompName(displayBox)
      ':box': displayBox
      ':data-bound-socket-data': dataBoundSocketData
    @click: onClick
props:
  box: null
  surfaceElement: null
  dataBoundSocketData: null
data:
  groupBox: null
  displayBox: null
methods:
  onClick: | #js
    function() {
      // #TODO: Find a way to not refresh manually
      //this.refresh();
    }
  onBoxIsLoading: | #js
    function(boxID, isLoading) {
      if (!this.groupBox.members.includes(boxID)) return;
      if (isLoading) return;
      // Whenever a member box is done loading, refresh the group box
      this.refresh();
    }
  init: | #js
    async function(box) {
      this.groupBox = box;
      await this.$nextTick();
      this.refresh();
    }
  refresh: | #js
    function() {
      const boxes = this.$root.boxes;
      const links = this.$root.links;
      this.displayBox = boxes.find(b => b._id == this.groupBox.displayBoxID);
    }
  getBoxCompName: | #js
    function(box) {
      if (!box?.type) return null;
      return `grid.ui.box.${box.type}`.replace(/\./g, "-");
    }
watch:
  box:
    handler: | #js
      async function(box) {
        this.init(box);
      }
    immediate: true
_:
  examples:
    count: 0
name: grid-ui-box-group
template: >-
  <div class="comp-grid-ui-box-group" @click="onClick"
  path="1087010666."><component :is="getBoxCompName(displayBox)"
  :box="displayBox" :data-bound-socket-data="dataBoundSocketData"
  path="1087010666.0"></component></div>
