dom:
  grid.module:
    icon: 🖼️
    ':show-title': 'false'
    img:
      ':style': '{ ''width'': ''100%''}'
      ':src': imageSrc
props:
  box: null
  dataBoundSocketData: null
data:
  activeSocketData: null
  boxValue: null
  imageSrc: null
mounted: | #js
  async function() {
    await this.$nextTick();
    this.refresh();
  }
methods:
  grid_client_runtime_socket_value_change: | #js
    function(boxID, sDirection, sID, sValue) {
      if (boxID != this.box._id) return;
      this.refresh();
    }
  getBoxVue: | #js
    function() {
      return this.$root.vm.getAncestors(this, "grid.ui.box")[0];
    }
  getActiveSocketData: | #js
    function() {
      let boxData = (this.$root.socket?.runtime.data[this.box._id] || {});
      boxData = Objects.deepMerge(boxData, (this.dataBoundSocketData || {}));
      return boxData;
    }
  getImageSrc: | #js
    function(boxValue) {
      if (boxValue?.tim) return `/fetch?url=https://i.4cdn.org/fit/${boxValue.tim}s.jpg`;
      return "/images/cat2.png";
    }
  refresh: | #js
    function() {
      this.activeSocketData = this.getActiveSocketData();
      this.boxValue = this.activeSocketData?.input?.[1];
      this.imageSrc = this.getImageSrc(this.boxValue);
    }
_:
  examples:
    count: 0
name: grid-ui-box-view-image
template: >-
  <grid-module class="comp-grid-ui-box-view-image" icon="🖼️"
  :show-title="false" path="2102057671."><img :style="{ 'width': '100%'}"
  :src="imageSrc" path="2102057671.0"/></grid-module>
