dom:
  grid.module:
    ':box': box
    ':data-bound-socket-data': dataBoundSocketData
    h2:
      ui.title:
        icon: 🎄
        ':text': node.type
    ui.tabs: 
      ':options': '[''🧊 data'', ''✨ style'']'
      direction: vertical
      ':can-select-none': 'true'
      ':value': null
      template: 
        v-slot: tab0
        div: 
          ui.linq:
            ':input': inputs?.[1]
            v-model: linq.operations
            @input: onLinqOperationsUpdate
      template: 
        v-slot: tab1
        div: 
          ui.tabs: 
            ':options': '[''🆎 font size'', ''🖼️ background'']'
            direction: vertical
            ':can-select-none': 'true'
            ':value': null
            template: 
              v-slot: tab0
              ui.input.font.size:
                @value-hover: previewFontSize
                v-model: fontSize
            template: 
              v-slot: tab1
              ui.input.background.color:
                v-if: 'true'
                @value-preview: previewBackgroundColor
                v-model: bgColorClass
props:
  box: null
  node: null
  dataBoundSocketData: null
data:
  inputs: null
  linq:
    operations: null
  fontSize: null
  bgColorClass: null
methods:
  previewFontSize: | #js
    function(e) {
      const value = (e.isHover ? e.value : null);
      this.previewStyle('fontSize', value);
    }
  previewBackgroundColor: | #js
    function(bgColorClass, isPreview) {
      this.previewClass(bgColorClass, isPreview);
    }
  previewClass: | #js
    function(className, isSet) {
      this.preview((element) => {
        if (isSet) {
          element.classList.add(className);
          element.classList.remove(this.bgColorClass);
        }
        else {
          element.classList.remove(className);
          element.classList.add(this.bgColorClass);
        }
      });
    }
  previewStyle: | #js
    function(key, value) {
      this.preview((element) => {
        element.style[key] = value;
      });
    }
  preview: | #js
    function(elementCallback) {
      const nodeSelector = `box_${this.box._id}_node_${this.node._id}`;
      const elements = document.getElementsByClassName(nodeSelector);
      for (const element of elements) elementCallback(element);
    }
  setFontSize: | #js
    function(fontSize) {
      this.setNodeData({ style: { 'fontSize': fontSize } });
    }
  setNodeData: | #js
    function(data) {
      const vBox = this.$root.vm.getAncestors(this, "grid.ui.box")[0];
      vBox.$femit("edit.node", this.box._id, this.node._id, data);
    }
  onLinqOperationsUpdate: | #js
    function() {
      const vBox = this.$root.vm.getAncestors(this, "grid.ui.box")[0];
      const viewNodeRoot = Objects.clone(this.box.viewNodeRoot);
      const node = TreeObject.find(viewNodeRoot, this.node._id);
      node.linq = this.linq;
      vBox.$femit("edit.box", this.box._id, { viewNodeRoot });
    }
  init: | #js
    function(node) {
      this.linq = (Objects.clone(node.linq) || {});
      this.linq.operations = (this.linq.operations || []);
      if (node.style) {
        this.fontSize = (node.style.css?.fontSize || null);
        this.bgColorClass = (node.style.bg?.class || null);
      }
    }
watch:
  node:
    handler: | #js
      function(node) {
        this.init(node);
      }
    immediate: true
  fontSize:
    handler: | #js
      function(fontSize) {
        this.setNodeData({ style: { css: { 'fontSize': fontSize } } });
      }
  bgColorClass:
    handler: | #js
      function(bgColorClass) {
        this.setNodeData({ style: { bg: { class: bgColorClass } } });
      }
style: null
_:
  examples:
    count: 0
name: grid-ui-node-settings
template: >-
  <grid-module class="comp-grid-ui-node-settings" :box="box"
  :data-bound-socket-data="dataBoundSocketData" path="-1191877027."><h2
  path="-1191877027.0"><ui-title icon="🎄" :text="node.type"
  path="-1191877027.0.0"></ui-title></h2><ui-tabs :options="['🧊 data', '✨
  style']" direction="vertical" :can-select-none="true"
  path="-1191877027.1"><template v-slot:tab0 path="-1191877027.1.0"><div
  path="-1191877027.1.0.0"><ui-linq :input="inputs?.[1]"
  v-model="linq.operations" @input="onLinqOperationsUpdate"
  path="-1191877027.1.0.0.0"></ui-linq></div></template><template v-slot:tab1
  path="-1191877027.1.1"><div path="-1191877027.1.1.0"><ui-tabs :options="['🆎
  font size', '🖼️ background']" direction="vertical" :can-select-none="true"
  path="-1191877027.1.1.0.0"><template v-slot:tab0
  path="-1191877027.1.1.0.0.0"><ui-input-font-size
  @value-hover="previewFontSize" v-model="fontSize"
  path="-1191877027.1.1.0.0.0.0"></ui-input-font-size></template><template
  v-slot:tab1 path="-1191877027.1.1.0.0.1"><ui-input-background-color
  v-if="true" @value-preview="previewBackgroundColor" v-model="bgColorClass"
  path="-1191877027.1.1.0.0.1.0"></ui-input-background-color></template></ui-tabs></div></template></ui-tabs></grid-module>
