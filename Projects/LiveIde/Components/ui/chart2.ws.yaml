dom:
  .w-100pc:
    v-if: every
    ui.chart:
      v-dim: isBusy
      ':class': cssClass
      ':header': getHeader()
      ':title': null
      ':data': values
      ':color': color
      ':scale': scale
    a:
      v-text: url
      ':href': url
      target: _blank
    .error:
      v-if: error
      v-text: error
props:
  entity: null
  app: null
  category: null
  event: null
  last: null
  every: null
  scale: null
data:
  values: []
  isBusy: 0
  error: null
mounted: | #js
  function() {
    this.fetchData();
  }
methods:
  fetchData: | #js
    async function() {
      this.isBusy++;
      this.values.clear();
      try
      {
        this.values = await (await fetch(this.url)).json();
      }
      finally
      {
        this.isBusy--;
      }
    }
  getHeader: | #js
    function() {
      return `${this.entity || this.event} in the last ${this.last}`;
    }
computed:
  url: | #js
    function() {
      try
      {
        this.error = null;
        if (this.entity)
        {
          let url = `https://db.memegenerator.net/MemeGenerator/analytics/${this.entity}/since/${this.last.deunitify().unitifyTime()}`;
          return url;
        }
        let { app, category, event, last, every } = this;
        last = last.deunitify().unitifyTime();
        every = every.deunitify().unitifyTime();
        let url = `https://db.memegenerator.net/analytics/${app}/${category}/${event}/last/${last}/every/${every}`;
        url = url.withoutColors();
        return url;
      }
      catch (ex)
      {
        this.error = ex.message;
        return null;
      }
    }
  color: | #js
    function() {
      return {
        "requests": "green",
        "response.time": "blue",
      }[this.event] || "";
    }
  cssClass: | #js
    function() {
      const cls = {};
      return cls;
      if (this.isBusy) cls["opacity-40"] = true;
      return cls;
    }
watch:
  url:
    handler: | #js
      async function() {
        await this.fetchData();
      }
    immediate: true
name: ui-chart2
template: >-
  <div class="comp-ui-chart2 w-100pc" v-if="every" path="-1898451794."><ui-chart
  v-dim="isBusy" :class="cssClass" :header="getHeader()" :data="values"
  :color="color" :scale="scale" path="-1898451794.0"></ui-chart><a v-text="url"
  :href="url" target="_blank" path="-1898451794.1"></a><div class="error"
  v-if="error" v-text="error" path="-1898451794.2"></div></div>
