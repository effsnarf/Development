dom:
  .row:
    :class: "{ selected: user.ui.is.selected }"
    @click: () => onClickUser(user)
    .check:
      input:
        type: checkbox
        v-model: user.ui.is.selected
    .icon:
      .circle:
        :style: "{ background: userColors[user.color.id] }"
        v-text: getInitials(user)
    .name-column:
      .name:
        ui.input.text.box:
          v-model: user.ui.edited.name
          :camouflage: "!user.ui.is.editing"
          :enabled: "user.ui.is.editing"
      .email:
        ui.input.text.box:
          v-model: user.ui.edited.email
          :camouflage: "!user.ui.is.editing"
          :enabled: "user.ui.is.editing"
    .permission:
      v-text: user.permission
    .buttons:
      div:
        button:
          class: edit
          title: "Edit"
          v-if: "!user.ui.is.editing"
          v-text: "'✏️'"
          @click: () => startEditing(user)
        button:
          class: delete
          title: "Delete"
          v-if: "showSaveButton(user)"
          v-text: "'✔️'"
          @click: () => saveEditing(user)
        button:
          class: cancel
          title: "Cancel"
          v-if: "user.ui.is.editing"
          v-text: "'❌'"
          @click: () => cancelEditing(user)
      div:
        v-if: "!user.ui.is.editing"
        button:
          v-text: "'🗑️'"
          @click: () => deleteUser(user)

props:
  user: null
  newEmptyUserID: null

data:
  userColors: {}

mounted: | #js
  function() {
    this.userColors = { '1': '#31F1AC', '2': '#1C40A3', '3': '#DE40A3' };
  }

methods:
  startEditing: | #js
    function(user) {
      user.ui.is.editing = true;
    }
  saveEditing: | #js
    function(user) {
      user.ui.is.editing = false;
      user.name = user.ui.edited.name;
      user.email = user.ui.edited.email;
      this.$emit('save', user);
    }
  deleteUser: | #js
    function(user) {
      this.$emit('delete', user);
    }
  cancelEditing: | #js
    function(user) {
      // If cancling a new user, remove it
      if (user.id == this.newEmptyUserID) {
        this.$emit('delete', user);
        return;
      }
      user.ui.is.editing = false;
    }
  onClickUser: | #js
    function(user) {
      user.ui.is.selected = !user.ui.is.selected;
    }
  showSaveButton: | #js
    function(user) {
      if (!user.ui.is.editing) return false;
      if (!user.ui.edited.name?.length) return false;
      if (!user.ui.edited.email?.length) return false;
      return true;
    }
  getInitials: | #js
    function(user) {
      return user.name.split(' ')
        .map(n => n[0])
        .slice(0, 2)
        .join('')
        .toUpperCase();
    }

style:
  .row:
    display: flex
    justify-content: space-between
    align-items: center
    gap: 1em
    cursor: pointer
  .row:hover:
    border: "1px solid #ffffff40"
    transition: 0s
  .selected, .selected:hover:
    background: "linear-gradient(45deg, #ffffff10, #ffffff30)"
  .check:
    flex-shrink: 1
  .icon:
    width: 4em
    flex-shrink: 1
  .name-column:
    flex-grow: 1
  .name:
    font-size: 140%
  .permission:
    width: 10em
  .circle:
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%
    aspect-ratio: 1
    font-size: 1.5em
    border-radius: 50%
  .buttons:
    display: flex
    align-items: center
    width: 8em
    gap: 0.5em
    opacity: 0
  .row:hover .buttons:
    opacity: 1
    transition: 1s
  button:
    box-shadow: none
  input[type=text]:
    opacity: 1 !important