dom:
  div:
    .tree-node:
      ':class': getCssClass()
      ui.expand:
        v-if: showUiExpand
        v-model: isExpanded
      component:
        v-if: itemType
        ':is': getItemType()
        ':item': getItem(node)
      @click: onNodeClick
      @mouseenter: onMouseEnter
      @mouseleave: onMouseLeave
      slot: null
    transition.group:
      name: list
      tag: ul
      class: ml-3
      li:
        v-for: child in getChildItems(node)
        :key: child.id
        ui.tree.node:
          ':node': child
          ':initial-expanded': initialExpanded
          ':expandable': expandable
          ':item-type': getItemType()
          ':get-item': getItem
          ':get-children': getChildren
          ':selected-node': selectedNode
          @node-click: onChildClick
          @node-hover: onChildHover
          @node-unhover: onChildUnhover
props:
  node: null
  initialExpanded: false
  expandable: true
  itemType: null
  getItem: null
  getChildren: null
  selectedNode: null
data:
  isInited: false
  isExpanded: null
methods:
  getCssClass: | #js
    function() {
      return {
        hoverable: true,
        selected: this.isSelected,
        expandable: this.expandable,
      };
    }
  onNodeClick: | #js
    function() {
      if (this.isSelected)
      {
          this.isExpanded = false;
          this.children = null;
      }
      else
      {
        this.isExpanded = true;        
        this.children = this.getChildren(this.node);
      }
      this.$emit('node-click', this.node);
    }
  onMouseEnter: | #js
    function() {
      this.$emit('node-hover', this.node);
    }
  onMouseLeave: | #js
    function() {
      this.$emit('node-unhover', this.node);
    }
  onChildClick: | #js
    function(child) {
      this.$emit('node-click', child);
    }
  onChildHover: | #js
    function (child) {
      this.$emit('node-hover', child);
    }
  onChildUnhover: | #js
    function (child) {
      this.$emit('node-unhover', child);
    }
  getItemType: | #js
    function() {
      return this.itemType?.replace(/\./g, '-');
    }
  getChildItems: | #js
    function(node) {
      if (!this.isExpanded) return [];
      return this.getChildren(node);
    }
computed:
  isSelected: | #js
    function() {
      return (this.node == this.selectedNode);
    }
  showUiExpand: | #js
    function() {
      if (!this.node) return false;
      return this.expandable;
    }
  depth: | #js
    function() {
      return this.$parent.depth + 1;
    }
watch:
  initialExpanded:
    handler: | #js
      function(newVal, oldVal) {
        if (this.isInited) return;
        this.isInited = true;
        this.isExpanded = (typeof newVal == 'boolean') ? newVal : (this.depth <= newVal);
      }
    immediate: true
style:
  .tree-node:
    display: flex
  .tree.node.expandable:
    display: grid
    grid-template: 1fr / 1.5em 1fr
  .comp-ui-expand:
    margin-right: 0.3em
  .comp-ui-expand .icon:
    font-size: 100% !important
    border: none !important
name: ui-tree-node
template: >-
  <div class="comp-ui-tree-node" path="2053324664."><div class="tree-node"
  :class="getCssClass()" @click="onNodeClick" @mouseenter="onMouseEnter"
  @mouseleave="onMouseLeave" path="2053324664.0"><ui-expand v-if="expandable"
  v-model="isExpanded" path="2053324664.0.0"></ui-expand><component
  v-if="itemType" :is="getItemType()" :item="getItem(node)"
  path="2053324664.0.1"></component><slot></slot></div><ul class="ml-3"
  path="2053324664.1"><li v-for="child in getChildItems(node)"
  path="2053324664.1.0"><ui-tree-node :node="child"
  :initial-expanded="initialExpanded" :expandable="expandable"
  :item-type="getItemType()" :get-item="getItem" :get-children="getChildren"
  :selected-node="selectedNode" @node-click="onChildClick"
  @node-hover="onChildHover" @node-unhover="onChildUnhover"
  path="2053324664.1.0.0"></ui-tree-node></li></ul></div>
