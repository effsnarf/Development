dom:
  div:
    ':style': mediaStyle
    e.template.editor:
      ':builder': cBuilder
      ':temp': temp
      ':editable': editable
      ':show-help': showHelp
      ':show-property-editor': showPropertyEditor
      ':cancel': cancel
      ':media-created': onMediaCreated
props:
  builder: null
  media: null
  editable: false
  showHelp: true
  showPropertyEditor: false
  mediaCreated: null
  cancel: null
data:
  temp: null
methods:
  initFromBuilder: | #js
    function (builder) {
      if (!builder) return;
      if (this.temp) return;
      this.temp = this.$root.builderSourceToTemplate(builder.format, builder.source);
    }
  onMediaCreated: | #js
    async function (media) {
      //this.initFromBuilder(this.builder);
      if (this.mediaCreated) await this.mediaCreated(media);
    }
  getMediaStyle: | #js
    function (builder) {
      const style = {};
      style.margin = "0 auto";
      if (builder?.source?.size?.max?.width) style['max-width'] = `${(parseInt(builder?.source?.size?.max?.width) + (!this.editable ? 0 : 15))}em`;
      return style;
    }
computed:
  cBuilder: | #js
    function () {
      return this.builder || this.$root.builders.all[this.media?.builderID];
    }
  mediaStyle: | #js
    function () {
      return this.getMediaStyle(this.cBuilder);
    }
watch:
  cBuilder:
    handler: | #js
      function(builder) {
        this.initFromBuilder(builder);
      }
    immediate: true
  builder:
    handler: | #js
      function(builder) {
        if (this.cBuilder) return;
        this.cBuilder = builder;
      }
    immediate: true
  media:
    handler: | #js
      async function(media) {
        if (!media) return;
        this.temp = await this.$root.mediaToTemp(media);
      }
    immediate: true
name: e-format-base
template: >-
  <div class="comp-e-format-base" :style="mediaStyle"
  path="-808258977."><e-template-editor :builder="cBuilder" :temp="temp"
  :editable="editable" :show-help="showHelp"
  :show-property-editor="showPropertyEditor" :cancel="cancel"
  :media-created="onMediaCreated" path="-808258977.0"></e-template-editor></div>
