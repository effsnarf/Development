dom:
  div:
    v-if: node?.vars
    div:
      v-for: varName in Object.keys(node.vars)
      h2:
        v-text: "'🧊 ' + varName"
      ui.tabs:
        :options: tabOptions
        direction: vertical
        :show-title-in-tab: "true"
        :value: getInitialSelectedTab(varName)
        template:
          v-slot: tab0
          studio.doc.node.common.data.editor.field:
            :node-var: node.vars[varName]
            :initial: initial
            :sui: sui
        template:
          v-slot: tab1
          h2:
            ui.input.text.box:
              hint: expression
              v-model: node.vars[varName].exp
        template:
          v-slot: tab2
          studio.doc.node.common.data.editor.url:
            :node-var: node.vars[varName]
      div:
        pre:
          v-if: "false"
          v-text: node

props:
  node:
  initial:
  userApp:
  userAppState:
  sui:

data:
  tabOptions: ['🍃 field', '🟰 exp', '🌐 fetch']

mounted: | #js
  function() {
  }

methods:
  getInitialSelectedTab: | #js
    function(varName) {
      const nodeVar = this.node.vars[varName];
      if (!nodeVar) return null;
      const types = nodeVar.type?.split('.');
      if (!types?.length) return null;
      return this.tabOptions.findIndex(t => (types.includes(t.split(' ').last())));
    }

computed:
    